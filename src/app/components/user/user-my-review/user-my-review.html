<app-user-nav></app-user-nav>

<div class="bg-light min-vh-100 p-4">
  <h2 class="text-center mb-4 fw-bold" style="color: #f05623;">My Thoughts üìù</h2>

  <!-- Reviews List -->
  <div class="row g-3" *ngIf="reviews.length > 0; else noReviews">
    <div class="col-md-6 col-lg-4" *ngFor="let review of reviews">
      <div class="card h-100 shadow-sm review-card border-0 rounded-3" style="transition: transform 0.2s, box-shadow 0.2s;">
        <div class="card-body">
          <h5 class="card-title text-center mb-3 fw-bold text-primary">{{ review.dishName }}</h5>
          
          <!-- Star Rating -->
          <div class="text-center mb-2">
            <span *ngFor="let filled of getStarArray(review.rating)">
              <i class="fas fa-star" [class.filled]="filled === 1" [class.empty]="filled === 0"></i>
            </span>
          </div>
          
          <!-- Date -->
          <p class="text-center mb-2 small text-muted">{{ review.date | date: 'MMM d, y' }}</p>
          
          <!-- Review Text -->
          <p class="text-center mb-3">{{ review.reviewText }}</p>
          
          <!-- Action Buttons -->
          <div class="d-flex gap-2 justify-content-center">
            <button class="btn btn-primary btn-sm flex-fill" (click)="viewDish(review.dishId)">
              View Dish
            </button>
            <button class="btn btn-danger btn-sm flex-fill" (click)="openDeleteModal(review)">
              Delete
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- No Reviews Message -->
  <ng-template #noReviews>
    <div class="alert alert-info text-center mt-5">
      <i class="fas fa-info-circle me-2"></i>
      No reviews found.
    </div>
  </ng-template>
</div>

<!-- Dish Details Modal -->
<div class="modal fade" [class.show]="showDishModal" [style.display]="showDishModal ? 'block' : 'none'" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content border-0 rounded-3" *ngIf="selectedDish">
      <div class="modal-header border-0">
        <h5 class="modal-title fw-bold">{{ selectedDish.dishName }}</h5>
        <button type="button" class="btn-close" (click)="closeDishModal()"></button>
      </div>
      <div class="modal-body text-center">
        <img [src]="selectedDish.coverImage" class="img-fluid rounded mb-3" [alt]="selectedDish.dishName" style="max-height: 250px; object-fit: cover;">
        <div class="text-start">
          <p class="mb-2"><strong>Price:</strong> <span class="text-success">‚Çπ{{ selectedDish.price }}</span></p>
          <p class="mb-2"><strong>Cuisine:</strong> {{ selectedDish.cuisine }}</p>
          <p class="mb-0"><strong>Description:</strong> {{ selectedDish.description }}</p>
        </div>
      </div>
      <div class="modal-footer border-0">
        <button type="button" class="btn btn-secondary" (click)="closeDishModal()">Close</button>
      </div>
    </div>
  </div>
</div>
<div class="modal-backdrop fade" [class.show]="showDishModal" *ngIf="showDishModal" (click)="closeDishModal()"></div>

<!-- Delete Confirmation Modal -->
<div class="modal fade" [class.show]="showDeleteModal" [style.display]="showDeleteModal ? 'block' : 'none'" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered modal-sm">
    <div class="modal-content border-0 rounded-3">
      <div class="modal-header border-0">
        <h5 class="modal-title fw-bold">Confirm Delete</h5>
        <button type="button" class="btn-close" (click)="closeDeleteModal()"></button>
      </div>
      <div class="modal-body text-center py-4">
        <i class="fas fa-exclamation-triangle text-warning fa-3x mb-3"></i>
        <p class="mb-0">Are you sure you want to delete this review?</p>
      </div>
      <div class="modal-footer border-0 justify-content-center">
        <button type="button" class="btn btn-secondary" (click)="closeDeleteModal()">Cancel</button>
        <button type="button" class="btn btn-danger" (click)="confirmDelete()">Yes, Delete</button>
      </div>
    </div>
  </div>
</div>
<div class="modal-backdrop fade" [class.show]="showDeleteModal" *ngIf="showDeleteModal" (click)="closeDeleteModal()"></div>
